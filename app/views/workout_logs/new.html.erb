<!-- app/views/workout_logs/new.html.erb -->
<div data-controller="log-builder" class="workout-logger">

  <!-- Header -->
  <div class="sticky-top bg-white border-bottom shadow-sm p-3 mb-4">
    <div class="text-center">
      <h2 class="mb-0">Today's <%= AppConstants::LABELS[@workout.muscle_group.to_sym] %> Workout</h2>
      <p class="text-muted mb-0">Edit your benchmark like a document</p>
    </div>
  </div>

  <!-- Main Content: Single Unified Editor -->
  <div class="container-fluid">
    <div class="row justify-content-center">
      <div class="col-lg-8">
        <div class="card">
          <div class="card-body">
            <textarea
              data-log-builder-target="workoutEditor"
              class="form-control workout-text-editor"
              rows="20"
              placeholder="# Exercise Name
First set description...
Second set description...

# Another Exercise
First set description...
Second set description..."
              style="font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace; font-size: 14px; line-height: 1.6;">
            </textarea>

            <div class="mt-3 text-muted small">
              <strong>Format:</strong> Use <code># Exercise Name</code> for exercises, then describe each set on separate lines.
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Fixed Bottom Section: Finish Workout -->
  <div class="fixed-bottom bg-white border-top shadow p-3">
    <%= form_with model: [@workout.split_day.split_plan, @workout.split_day, @workout, @log],
                  local: true,
                  id: "workout-form",
                  data: { log_builder_target: "form" } do |f| %>

      <%= hidden_field_tag "workout_log[details]", "", data: { log_builder_target: "hiddenDetails" } %>

      <div class="row align-items-center">
        <div class="col-md-6">
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="beat_benchmark" id="beat_yes" value="yes">
            <label class="form-check-label" for="beat_yes">
              <strong class="text-success">âœ… Update my benchmark</strong>
            </label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="beat_benchmark" id="beat_no" value="no">
            <label class="form-check-label" for="beat_no">
              <strong class="text-muted">ðŸ“Š Just save this workout</strong>
            </label>
          </div>
        </div>

        <div class="col-md-6 text-end">
          <%= f.submit "Finish Workout",
                       class: "btn btn-success btn-lg px-4",
                       data: { log_builder_target: "submitButton" } %>
        </div>
      </div>
    <% end %>
  </div>

</div>

<!-- Pass benchmark data to JavaScript -->
<script>
  window.benchmarkData = <%= raw(@workout.details.present? ? @workout.details : '{}') %>;
</script>
